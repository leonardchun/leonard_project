##  一、分布式锁实现方式

1、 基于数据库实现分布式锁 ;

2、 基于缓存（Redis等）实现分布式锁 ;

3、 基于Zookeeper实现分布式锁 ;

## 二、 基于数据库实现分布式锁 

1、悲观锁 

2、乐观锁



## 三、 基于缓存（Redis等）实现分布式锁  





## 四、 基于Zookeeper实现分布式锁



## 五、比较

数据库分布式锁实现
缺点：

1.db操作性能较差，并且有锁表的风险
2.非阻塞操作失败后，需要轮询，占用cpu资源;
3.长时间不commit或者长时间轮询，可能会占用较多连接资源

Redis(缓存)分布式锁实现
缺点：

1.锁删除失败 过期时间不好控制
2.非阻塞，操作失败后，需要轮询，占用cpu资源;

ZK分布式锁实现
缺点：性能不如redis实现，主要原因是写操作（获取锁释放锁）都需要在Leader上执行，然后同步到follower。

总之：ZooKeeper有较好的性能和可靠性。

从理解的难易程度角度（从低到高）数据库 > 缓存 > Zookeeper

从实现的复杂性角度（从低到高）Zookeeper >= 缓存 > 数据库

从性能角度（从高到低）缓存 > Zookeeper >= 数据库

从可靠性角度（从高到低）Zookeeper > 缓存 > 数据库 

https://www.php.cn/faq/466231.html